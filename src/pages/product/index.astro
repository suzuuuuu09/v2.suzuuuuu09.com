---
import { getProductPosts } from "@/lib/post";
import BaseLayout from "@/layouts/BaseLayout.astro";
import { ArticleGrid } from "@/components/features/blog/ArticleGrid";
import SectionTitle from "@/components/shared/SectionTitle.astro";
import { Expand } from "@/components/shared/Expand";
import ProductCard from "@/components/features/product/ProductCard.astro";

const products = await getProductPosts();
---

<BaseLayout title="Products">
  <SectionTitle>Products</SectionTitle>
  <Expand>
    {
      products.length === 0 ? (
        <p>No products found.</p>
      ) : (
        <ArticleGrid>
          {products.map((product) => (
            <ProductCard
              product={{
                id: product.id,
                data: {
                  ...product.data,
                  slug: product.data.slug ?? product.id,
                  content: product.body,
                  description: product.data.description ?? undefined,
                },
              }}
            />
          ))}
        </ArticleGrid>
      )
    }
  </Expand>
</BaseLayout>
