---
import { getIconData } from "@/utils/icon";
import { VStack, styled as s } from "styled-system/jsx";
import { css } from "styled-system/css";
import Icon from "@suzuuuuu09/astro-iconify";

interface Props {
	iconKey: string;
	showName?: boolean;
	size?: number;
}

const { iconKey, showName = true, size = 60 } = Astro.props;

const iconData = getIconData(iconKey);

function calculateCardLayout(iconSize: number, showName: boolean) {
	const containerWidth = Math.max(iconSize + 16, 90);
	const iconAreaHeight = iconSize + 8;
	const textAreaHeight = showName ? 42 : 0;
	const containerHeight = iconAreaHeight + textAreaHeight + 16;

	return {
		containerWidth,
		containerHeight,
		iconAreaHeight,
		textAreaHeight,
	};
}

const iconName = iconData?.icon || iconKey;
const displayName = iconData?.name || iconKey;
const iconColor = iconData?.color;
const layout = calculateCardLayout(size, showName);
---

<VStack
  rounded="lg"
  gap="2"
  alignItems="center"
  width={`${layout.containerWidth}px`}
  height={`${layout.containerHeight}px`}
>
  <VStack
    alignItems="center"
    justifyContent="center"
    height={`${layout.iconAreaHeight}px`}
    p="2"
  >
    <Icon
      name={iconName}
      size={size}
      class={iconColor ? undefined : css({ color: "sz.icon" })}
      style={iconColor ? `color: ${iconColor}` : undefined}
    />
  </VStack>
  {
    showName && (
      <s.span
        fontSize="base"
        color="sz.text.main"
        fontWeight="medium"
        textAlign="center"
        height={`${layout.textAreaHeight}px`}
      >
        {displayName}
      </s.span>
    )
  }
</VStack>
